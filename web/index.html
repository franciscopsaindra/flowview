<html>
  <head>
	<meta http-equiv="efresh" content="5">
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script type="text/javascript">
      google.charts.load('current', {'packages':['sankey']});
      google.charts.setOnLoadCallback(drawChart);

      function drawChart() {
        var data = new google.visualization.DataTable();
        data.addColumn('string', 'From');
        data.addColumn('string', 'To');
        data.addColumn('number', 'Weight');
	
        // Sets chart options.
        var options = {
          width: 1000,
	      height: 5000
        };

        // Instantiates and draws our chart, passing in some options.
        var chart = new google.visualization.Sankey(document.getElementById('mygraph'));
		var dataType = location.search.substring(1);
        $.getJSON(dataType, function(jsData, status){
		
		  // normalize data
		  if(dataType == 'cdrRateDerivative'){
			for(var i = 0; i < jsData.length; i++){
				jsData[i][2]=parseInt(Math.abs(jsData[i][2]*10));
				if(jsData[i][2] == 0) jsData[i][2] = 1;
			}
		  }
          data.addRows(jsData);
          chart.draw(data, options);
        });
      }
    </script>
  </head>
  <body>
    <div id="mygraph" style="width: 900px; height: 300px;"></div>
  </body>
</html>

